import{r as u,j as e,_ as N}from"./index-7dfafbc9.js";import{B as v,a as _}from"./App-774b7160.js";import{u as b}from"./useUserProfile-f77a962c.js";import{f as P}from"./helpers-01b1bc81.js";import S from"./index-e9750c15.js";import"./useIsUserLoggedIn-20807ce1.js";function C(){const{user:r}=b(),[l,f]=u.useState([]),[x,c]=u.useState(!1);if(!(r!=null&&r.iam))return e.jsx(S,{});function p(a){const t=a.target.files||[];c(!0),N(()=>import("./mediaTags-ba9bb244.js"),[]).then(async({readTags:o})=>{for(const m of t)try{await o(m).then(({title:i,artist:j,album:g,year:y,albumArt:d})=>{const n={title:i,artist:j,album:g,year:y,albumArt:d,file:m};P(d.pictureData).then(s=>(n.pictureUrl=s,n)).catch(s=>console.error(s)).finally(()=>{f(s=>[...s,n])})})}catch(i){console.log("Failed for",i)}}).catch(o=>{console.log("failed to import readTags",o)}).finally(()=>{c(!1)})}function h(a){a.preventDefault(),_.post("/music/song",l.map(t=>({title:t.title,artist:t.artist,album:t.album,year:t.year,file:t.file})),{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{console.log({res:t})}).catch(t=>{console.log(t)})}return console.log({songsAndMeta:l}),e.jsx("div",{children:e.jsxs("div",{className:"p-4 m-4 rounded-lg bg-neutral-600/40 ",children:[e.jsx("h1",{className:"text-xl font-bold text-neutral-300",children:"Upload Song"}),e.jsxs("form",{onSubmit:h,className:"flex flex-col items-center justify-center m-2",children:[e.jsx("input",{type:"file",className:"px-2 py-4 text-center rounded-md bg-neutral-600",onChange:p,multiple:!0,accept:".mp3, .aac,.flac,.wav"}),e.jsx("ul",{className:"overflow-y-scroll max-h-[400px] my-4",children:l.map(a=>e.jsxs("li",{className:"flex m-2",children:[e.jsx("img",{src:a.pictureUrl,className:"w-16 h-16"}),e.jsxs("div",{className:"ml-2 text-sm",children:[e.jsx("h5",{children:a.title}),e.jsx("h5",{className:"text-xs text-neutral-300",children:a.artist}),e.jsx("h5",{className:"text-xs text-neutral-300",children:a.album})]})]},a.title))}),e.jsx(v,{disabled:x||!l.length,className:"m-2 mt-6 px-9",children:"Upload"})]})]})})}export{C as default};
